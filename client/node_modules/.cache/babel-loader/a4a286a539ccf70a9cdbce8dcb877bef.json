{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport React, { forwardRef, useCallback, useRef } from \"react\";\nimport cn from \"classnames\";\nimport { List } from \"@react-md/list\";\nimport { ScaleTransition } from \"@react-md/transition\";\nimport { bem, DEFAULT_GET_ITEM_VALUE, MovementPresets, omit, scrollIntoView, useActiveDescendantMovement } from \"@react-md/utils\";\nimport { Option } from \"./Option\";\nimport { defaultIsOptionDisabled, getOptionId as DEFAULT_GET_OPTION_ID, getOptionLabel as DEFAULT_GET_OPTION_LABEL, isListboxOptionProps } from \"./utils\";\nvar block = bem(\"rmd-listbox\");\nvar warned;\n/**\n * This component is used to render the list part of a `<select>` element with\n * built-in accessibility and the ability to add custom styles. This should\n * probably not be used much outside of `react-md` itself and the `Select`\n * component, but I'm planning on adding support for an inline listbox at some\n * point.\n */\n\nexport var Listbox = forwardRef(function Listbox(_a, ref) {\n  var className = _a.className,\n      _b = _a.visible,\n      visible = _b === void 0 ? true : _b,\n      _c = _a.temporary,\n      temporary = _c === void 0 ? false : _c,\n      _d = _a.labelKey,\n      labelKey = _d === void 0 ? \"label\" : _d,\n      _e = _a.valueKey,\n      valueKey = _e === void 0 ? \"value\" : _e,\n      _f = _a.getOptionId,\n      getOptionId = _f === void 0 ? DEFAULT_GET_OPTION_ID : _f,\n      _g = _a.getOptionLabel,\n      getOptionLabel = _g === void 0 ? DEFAULT_GET_OPTION_LABEL : _g,\n      _h = _a.getOptionValue,\n      getOptionValue = _h === void 0 ? DEFAULT_GET_ITEM_VALUE : _h,\n      _j = _a.isOptionDisabled,\n      isOptionDisabled = _j === void 0 ? defaultIsOptionDisabled : _j,\n      _k = _a.disableMovementChange,\n      disableMovementChange = _k === void 0 ? false : _k,\n      onFocus = _a.onFocus,\n      propOnKeyDown = _a.onKeyDown,\n      name = _a.name,\n      options = _a.options,\n      value = _a.value,\n      onChange = _a.onChange,\n      propTabIndex = _a.tabIndex,\n      portal = _a.portal,\n      portalInto = _a.portalInto,\n      portalIntoId = _a.portalIntoId,\n      onRequestClose = _a.onRequestClose,\n      timeout = _a.timeout,\n      readOnly = _a.readOnly,\n      classNames = _a.classNames,\n      mountOnEnter = _a.mountOnEnter,\n      unmountOnExit = _a.unmountOnExit,\n      onEnter = _a.onEnter,\n      onEntering = _a.onEntering,\n      onEntered = _a.onEntered,\n      onExit = _a.onExit,\n      onExiting = _a.onExiting,\n      onExited = _a.onExited,\n      props = __rest(_a, [\"className\", \"visible\", \"temporary\", \"labelKey\", \"valueKey\", \"getOptionId\", \"getOptionLabel\", \"getOptionValue\", \"isOptionDisabled\", \"disableMovementChange\", \"onFocus\", \"onKeyDown\", \"name\", \"options\", \"value\", \"onChange\", \"tabIndex\", \"portal\", \"portalInto\", \"portalIntoId\", \"onRequestClose\", \"timeout\", \"readOnly\", \"classNames\", \"mountOnEnter\", \"unmountOnExit\", \"onEnter\", \"onEntering\", \"onEntered\", \"onExit\", \"onExiting\", \"onExited\"]);\n\n  var id = props.id;\n  var tabIndex = propTabIndex;\n\n  if (temporary) {\n    tabIndex = -1;\n  } else if (typeof propTabIndex === \"undefined\") {\n    tabIndex = 0;\n  }\n  /**\n   * Gets the current index of the option that has the same value as the\n   * provided prop value.\n   */\n\n\n  var getIndex = useCallback(function () {\n    return options.findIndex(function (option) {\n      return value === getOptionValue(option, valueKey);\n    });\n  }, [getOptionValue, options, value, valueKey]);\n  /**\n   * Conditionally calls the onChange callback with the new value and option if\n   * the value has changed. This will be called when:\n   * - the user presses the enter or space key while \"focusing\" an option\n   * - the user keyboard navigates to a new option while the\n   *   `disableMovementChange` prop is `false`\n   * - the user clicks the option with a mouse or touch\n   */\n\n  var handleChange = useCallback(function (index) {\n    if (readOnly) {\n      return;\n    }\n\n    var option = options[index];\n\n    if (!option || isOptionDisabled(option)) {\n      return;\n    }\n\n    var optionValue = getOptionValue(option, valueKey);\n\n    if (value !== optionValue) {\n      onChange(optionValue, options[index], {\n        id: id,\n        name: name,\n        value: value,\n        valueKey: valueKey,\n        options: options\n      });\n    }\n  }, [getOptionValue, id, isOptionDisabled, name, onChange, options, readOnly, value, valueKey]);\n  var handleKeyboardClick = useCallback(function (focusedIndex) {\n    handleChange(focusedIndex);\n\n    if (temporary && onRequestClose) {\n      onRequestClose();\n    }\n  }, [handleChange, onRequestClose, temporary]);\n\n  var _l = useActiveDescendantMovement(__assign(__assign({}, MovementPresets.VERTICAL_LISTBOX), {\n    defaultFocusedIndex: getIndex,\n    items: options,\n    baseId: id,\n    valueKey: labelKey,\n    getId: getOptionId,\n    getItemValue: function (option, key) {\n      if (!isListboxOptionProps(option)) {\n        return \"\" + option;\n      }\n\n      var search = option[key];\n\n      if (typeof search === \"number\" || typeof search === \"string\") {\n        return \"\" + search;\n      }\n\n      if (process.env.NODE_ENV !== \"production\") {\n        if (!warned) {\n          warned = new Set();\n        }\n\n        if (!warned.has(id)) {\n          /* eslint-disable no-console */\n          console.warn(\"A listbox with an id of \\\"\" + id + \"\\\" has an option that does not have a searchable label string. \" + \"Users will be unable to use the typeahead feature in the Listbox component until this is fixed. \" + \"To fix this warning, you can use the `labelKey` prop on the `Listbox`/`Select` component to point \" + \"to a string on the following option:\", option);\n          warned.add(id);\n        }\n      }\n\n      return \"\";\n    },\n    onChange: function (data) {\n      if (disableMovementChange) {\n        return;\n      }\n\n      handleChange(data.index);\n    },\n    onEnter: handleKeyboardClick,\n    onSpace: handleKeyboardClick,\n    onKeyDown: function (event) {\n      if (propOnKeyDown) {\n        propOnKeyDown(event);\n      }\n\n      switch (event.key) {\n        case \"Tab\":\n        case \"Escape\":\n          if (event.key === \"Escape\") {\n            event.stopPropagation();\n          }\n\n          if (temporary && onRequestClose) {\n            onRequestClose();\n          }\n\n          break;\n        // no default\n      }\n    }\n  })),\n      activeId = _l.activeId,\n      itemRefs = _l.itemRefs,\n      onKeyDown = _l.onKeyDown,\n      focusedIndex = _l.focusedIndex,\n      setFocusedIndex = _l.setFocusedIndex;\n\n  var prevVisible = useRef(visible);\n\n  if (visible !== prevVisible.current) {\n    prevVisible.current = visible; // whenever it gains visibility, try to set the focused index to the\n    // current active value\n\n    if (visible) {\n      setFocusedIndex(getIndex());\n    }\n  }\n\n  var handleFocus = useCallback(function (event) {\n    if (onFocus) {\n      onFocus(event);\n    }\n\n    var item = itemRefs[focusedIndex] && itemRefs[focusedIndex].current;\n\n    if (item) {\n      scrollIntoView(event.currentTarget, item);\n    }\n  }, [focusedIndex, itemRefs, onFocus]);\n  return React.createElement(ScaleTransition, {\n    portal: portal,\n    portalInto: portalInto,\n    portalIntoId: portalIntoId,\n    visible: !temporary || visible,\n    vertical: true,\n    timeout: timeout,\n    classNames: classNames,\n    mountOnEnter: mountOnEnter,\n    unmountOnExit: unmountOnExit,\n    onEnter: onEnter,\n    onEntering: onEntering,\n    onEntered: onEntered,\n    onExit: onExit,\n    onExiting: onExiting,\n    onExited: onExited\n  }, React.createElement(List, __assign({}, props, {\n    \"aria-activedescendant\": activeId,\n    ref: ref,\n    role: \"listbox\",\n    tabIndex: tabIndex,\n    className: cn(block({\n      temporary: temporary\n    }), className),\n    onFocus: handleFocus,\n    onKeyDown: onKeyDown\n  }), options.map(function (option, i) {\n    var optionId = getOptionId(id, i);\n    var optionValue = getOptionValue(option, valueKey);\n    var optionLabel = getOptionLabel(option, labelKey);\n    var optionProps;\n\n    if (isListboxOptionProps(option)) {\n      optionProps = omit(option, [labelKey, valueKey]);\n    }\n\n    var disabled = isOptionDisabled(option);\n    var onClick;\n\n    if (!readOnly && !disabled) {\n      onClick = function () {\n        handleChange(i);\n        setFocusedIndex(i);\n      };\n    }\n\n    return React.createElement(Option, __assign({\n      key: optionValue,\n      id: optionId,\n      disabled: disabled\n    }, optionProps, {\n      ref: itemRefs[i],\n      focused: optionId === activeId,\n      selected: value === optionValue,\n      onClick: onClick\n    }), optionLabel);\n  })));\n});\n/* istanbul ignore next */\n\nif (process.env.NODE_ENV !== \"production\") {\n  try {\n    var PropTypes = require(\"prop-types\");\n\n    Listbox.propTypes = {\n      id: PropTypes.string.isRequired,\n      value: PropTypes.string.isRequired,\n      onChange: PropTypes.func.isRequired,\n      className: PropTypes.string,\n      labelKey: PropTypes.string,\n      valueKey: PropTypes.string,\n      getOptionId: PropTypes.func,\n      getOptionLabel: PropTypes.func,\n      getOptionValue: PropTypes.func,\n      isOptionDisabled: PropTypes.func,\n      visible: PropTypes.bool,\n      temporary: PropTypes.bool,\n      onRequestClose: PropTypes.func,\n      disableMovementChange: PropTypes.bool,\n      timeout: PropTypes.oneOfType([PropTypes.number, PropTypes.shape({\n        enter: PropTypes.number,\n        exit: PropTypes.number\n      })]),\n      classNames: PropTypes.oneOfType([PropTypes.string, PropTypes.shape({\n        appear: PropTypes.string,\n        appearActive: PropTypes.string,\n        enter: PropTypes.string,\n        enterActive: PropTypes.string,\n        enterDone: PropTypes.string,\n        exit: PropTypes.string,\n        exitActive: PropTypes.string,\n        exitDone: PropTypes.string\n      })]),\n      readOnly: PropTypes.bool,\n      mountOnEnter: PropTypes.bool,\n      unmountOnExit: PropTypes.bool,\n      onEnter: PropTypes.func,\n      onEntering: PropTypes.func,\n      onEntered: PropTypes.func,\n      onExit: PropTypes.func,\n      onExiting: PropTypes.func,\n      onExited: PropTypes.func,\n      portal: PropTypes.bool,\n      portalInto: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n      portalIntoId: PropTypes.string,\n      tabIndex: PropTypes.number,\n      onFocus: PropTypes.func,\n      onKeyDown: PropTypes.func,\n      name: PropTypes.string,\n      options: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.number, PropTypes.object])).isRequired\n    };\n  } catch (e) {}\n}","map":{"version":3,"sources":["../../src/select/Listbox.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport React, { forwardRef, useCallback, useRef } from \"react\";\nimport cn from \"classnames\";\nimport { List } from \"@react-md/list\";\nimport { ScaleTransition, } from \"@react-md/transition\";\nimport { bem, DEFAULT_GET_ITEM_VALUE, MovementPresets, omit, scrollIntoView, useActiveDescendantMovement, } from \"@react-md/utils\";\nimport { Option } from \"./Option\";\nimport { defaultIsOptionDisabled, getOptionId as DEFAULT_GET_OPTION_ID, getOptionLabel as DEFAULT_GET_OPTION_LABEL, isListboxOptionProps, } from \"./utils\";\nvar block = bem(\"rmd-listbox\");\nvar warned;\n/**\n * This component is used to render the list part of a `<select>` element with\n * built-in accessibility and the ability to add custom styles. This should\n * probably not be used much outside of `react-md` itself and the `Select`\n * component, but I'm planning on adding support for an inline listbox at some\n * point.\n */\nexport var Listbox = forwardRef(function Listbox(_a, ref) {\n    var className = _a.className, _b = _a.visible, visible = _b === void 0 ? true : _b, _c = _a.temporary, temporary = _c === void 0 ? false : _c, _d = _a.labelKey, labelKey = _d === void 0 ? \"label\" : _d, _e = _a.valueKey, valueKey = _e === void 0 ? \"value\" : _e, _f = _a.getOptionId, getOptionId = _f === void 0 ? DEFAULT_GET_OPTION_ID : _f, _g = _a.getOptionLabel, getOptionLabel = _g === void 0 ? DEFAULT_GET_OPTION_LABEL : _g, _h = _a.getOptionValue, getOptionValue = _h === void 0 ? DEFAULT_GET_ITEM_VALUE : _h, _j = _a.isOptionDisabled, isOptionDisabled = _j === void 0 ? defaultIsOptionDisabled : _j, _k = _a.disableMovementChange, disableMovementChange = _k === void 0 ? false : _k, onFocus = _a.onFocus, propOnKeyDown = _a.onKeyDown, name = _a.name, options = _a.options, value = _a.value, onChange = _a.onChange, propTabIndex = _a.tabIndex, portal = _a.portal, portalInto = _a.portalInto, portalIntoId = _a.portalIntoId, onRequestClose = _a.onRequestClose, timeout = _a.timeout, readOnly = _a.readOnly, classNames = _a.classNames, mountOnEnter = _a.mountOnEnter, unmountOnExit = _a.unmountOnExit, onEnter = _a.onEnter, onEntering = _a.onEntering, onEntered = _a.onEntered, onExit = _a.onExit, onExiting = _a.onExiting, onExited = _a.onExited, props = __rest(_a, [\"className\", \"visible\", \"temporary\", \"labelKey\", \"valueKey\", \"getOptionId\", \"getOptionLabel\", \"getOptionValue\", \"isOptionDisabled\", \"disableMovementChange\", \"onFocus\", \"onKeyDown\", \"name\", \"options\", \"value\", \"onChange\", \"tabIndex\", \"portal\", \"portalInto\", \"portalIntoId\", \"onRequestClose\", \"timeout\", \"readOnly\", \"classNames\", \"mountOnEnter\", \"unmountOnExit\", \"onEnter\", \"onEntering\", \"onEntered\", \"onExit\", \"onExiting\", \"onExited\"]);\n    var id = props.id;\n    var tabIndex = propTabIndex;\n    if (temporary) {\n        tabIndex = -1;\n    }\n    else if (typeof propTabIndex === \"undefined\") {\n        tabIndex = 0;\n    }\n    /**\n     * Gets the current index of the option that has the same value as the\n     * provided prop value.\n     */\n    var getIndex = useCallback(function () {\n        return options.findIndex(function (option) { return value === getOptionValue(option, valueKey); });\n    }, [getOptionValue, options, value, valueKey]);\n    /**\n     * Conditionally calls the onChange callback with the new value and option if\n     * the value has changed. This will be called when:\n     * - the user presses the enter or space key while \"focusing\" an option\n     * - the user keyboard navigates to a new option while the\n     *   `disableMovementChange` prop is `false`\n     * - the user clicks the option with a mouse or touch\n     */\n    var handleChange = useCallback(function (index) {\n        if (readOnly) {\n            return;\n        }\n        var option = options[index];\n        if (!option || isOptionDisabled(option)) {\n            return;\n        }\n        var optionValue = getOptionValue(option, valueKey);\n        if (value !== optionValue) {\n            onChange(optionValue, options[index], {\n                id: id,\n                name: name,\n                value: value,\n                valueKey: valueKey,\n                options: options,\n            });\n        }\n    }, [\n        getOptionValue,\n        id,\n        isOptionDisabled,\n        name,\n        onChange,\n        options,\n        readOnly,\n        value,\n        valueKey,\n    ]);\n    var handleKeyboardClick = useCallback(function (focusedIndex) {\n        handleChange(focusedIndex);\n        if (temporary && onRequestClose) {\n            onRequestClose();\n        }\n    }, [handleChange, onRequestClose, temporary]);\n    var _l = useActiveDescendantMovement(__assign(__assign({}, MovementPresets.VERTICAL_LISTBOX), { defaultFocusedIndex: getIndex, items: options, baseId: id, valueKey: labelKey, getId: getOptionId, getItemValue: function (option, key) {\n            if (!isListboxOptionProps(option)) {\n                return \"\" + option;\n            }\n            var search = option[key];\n            if (typeof search === \"number\" || typeof search === \"string\") {\n                return \"\" + search;\n            }\n            if (process.env.NODE_ENV !== \"production\") {\n                if (!warned) {\n                    warned = new Set();\n                }\n                if (!warned.has(id)) {\n                    /* eslint-disable no-console */\n                    console.warn(\"A listbox with an id of \\\"\" + id + \"\\\" has an option that does not have a searchable label string. \" +\n                        \"Users will be unable to use the typeahead feature in the Listbox component until this is fixed. \" +\n                        \"To fix this warning, you can use the `labelKey` prop on the `Listbox`/`Select` component to point \" +\n                        \"to a string on the following option:\", option);\n                    warned.add(id);\n                }\n            }\n            return \"\";\n        },\n        onChange: function (data) {\n            if (disableMovementChange) {\n                return;\n            }\n            handleChange(data.index);\n        }, onEnter: handleKeyboardClick, onSpace: handleKeyboardClick, onKeyDown: function (event) {\n            if (propOnKeyDown) {\n                propOnKeyDown(event);\n            }\n            switch (event.key) {\n                case \"Tab\":\n                case \"Escape\":\n                    if (event.key === \"Escape\") {\n                        event.stopPropagation();\n                    }\n                    if (temporary && onRequestClose) {\n                        onRequestClose();\n                    }\n                    break;\n                // no default\n            }\n        } })), activeId = _l.activeId, itemRefs = _l.itemRefs, onKeyDown = _l.onKeyDown, focusedIndex = _l.focusedIndex, setFocusedIndex = _l.setFocusedIndex;\n    var prevVisible = useRef(visible);\n    if (visible !== prevVisible.current) {\n        prevVisible.current = visible;\n        // whenever it gains visibility, try to set the focused index to the\n        // current active value\n        if (visible) {\n            setFocusedIndex(getIndex());\n        }\n    }\n    var handleFocus = useCallback(function (event) {\n        if (onFocus) {\n            onFocus(event);\n        }\n        var item = itemRefs[focusedIndex] && itemRefs[focusedIndex].current;\n        if (item) {\n            scrollIntoView(event.currentTarget, item);\n        }\n    }, [focusedIndex, itemRefs, onFocus]);\n    return (React.createElement(ScaleTransition, { portal: portal, portalInto: portalInto, portalIntoId: portalIntoId, visible: !temporary || visible, vertical: true, timeout: timeout, classNames: classNames, mountOnEnter: mountOnEnter, unmountOnExit: unmountOnExit, onEnter: onEnter, onEntering: onEntering, onEntered: onEntered, onExit: onExit, onExiting: onExiting, onExited: onExited },\n        React.createElement(List, __assign({}, props, { \"aria-activedescendant\": activeId, ref: ref, role: \"listbox\", tabIndex: tabIndex, className: cn(block({ temporary: temporary }), className), onFocus: handleFocus, onKeyDown: onKeyDown }), options.map(function (option, i) {\n            var optionId = getOptionId(id, i);\n            var optionValue = getOptionValue(option, valueKey);\n            var optionLabel = getOptionLabel(option, labelKey);\n            var optionProps;\n            if (isListboxOptionProps(option)) {\n                optionProps = omit(option, [labelKey, valueKey]);\n            }\n            var disabled = isOptionDisabled(option);\n            var onClick;\n            if (!readOnly && !disabled) {\n                onClick = function () {\n                    handleChange(i);\n                    setFocusedIndex(i);\n                };\n            }\n            return (React.createElement(Option, __assign({ key: optionValue, id: optionId, disabled: disabled }, optionProps, { ref: itemRefs[i], focused: optionId === activeId, selected: value === optionValue, onClick: onClick }), optionLabel));\n        }))));\n});\n/* istanbul ignore next */\nif (process.env.NODE_ENV !== \"production\") {\n    try {\n        var PropTypes = require(\"prop-types\");\n        Listbox.propTypes = {\n            id: PropTypes.string.isRequired,\n            value: PropTypes.string.isRequired,\n            onChange: PropTypes.func.isRequired,\n            className: PropTypes.string,\n            labelKey: PropTypes.string,\n            valueKey: PropTypes.string,\n            getOptionId: PropTypes.func,\n            getOptionLabel: PropTypes.func,\n            getOptionValue: PropTypes.func,\n            isOptionDisabled: PropTypes.func,\n            visible: PropTypes.bool,\n            temporary: PropTypes.bool,\n            onRequestClose: PropTypes.func,\n            disableMovementChange: PropTypes.bool,\n            timeout: PropTypes.oneOfType([\n                PropTypes.number,\n                PropTypes.shape({\n                    enter: PropTypes.number,\n                    exit: PropTypes.number,\n                }),\n            ]),\n            classNames: PropTypes.oneOfType([\n                PropTypes.string,\n                PropTypes.shape({\n                    appear: PropTypes.string,\n                    appearActive: PropTypes.string,\n                    enter: PropTypes.string,\n                    enterActive: PropTypes.string,\n                    enterDone: PropTypes.string,\n                    exit: PropTypes.string,\n                    exitActive: PropTypes.string,\n                    exitDone: PropTypes.string,\n                }),\n            ]),\n            readOnly: PropTypes.bool,\n            mountOnEnter: PropTypes.bool,\n            unmountOnExit: PropTypes.bool,\n            onEnter: PropTypes.func,\n            onEntering: PropTypes.func,\n            onEntered: PropTypes.func,\n            onExit: PropTypes.func,\n            onExiting: PropTypes.func,\n            onExited: PropTypes.func,\n            portal: PropTypes.bool,\n            portalInto: PropTypes.oneOfType([PropTypes.object, PropTypes.string]),\n            portalIntoId: PropTypes.string,\n            tabIndex: PropTypes.number,\n            onFocus: PropTypes.func,\n            onKeyDown: PropTypes.func,\n            name: PropTypes.string,\n            options: PropTypes.arrayOf(PropTypes.oneOfType([\n                PropTypes.string,\n                PropTypes.number,\n                PropTypes.object,\n            ])).isRequired,\n        };\n    }\n    catch (e) { }\n}\n//# sourceMappingURL=Listbox.js.map"]},"metadata":{},"sourceType":"module"}